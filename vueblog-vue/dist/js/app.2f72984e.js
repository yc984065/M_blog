(function(e){function t(t){for(var s,i,n=t[0],l=t[1],c=t[2],u=0,g=[];u<n.length;u++)i=n[u],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&g.push(r[i][0]),r[i]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);d&&d(t);while(g.length)g.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],s=!0,n=1;n<a.length;n++){var l=a[n];0!==r[l]&&(s=!1)}s&&(o.splice(t--,1),e=i(i.s=a[0]))}return e}var s={},r={app:0},o=[];function i(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=s,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(a,s,function(t){return e[t]}.bind(null,s));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],l=n.push.bind(n);n.push=t,n=n.slice();for(var c=0;c<n.length;c++)t(n[c]);var d=l;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"059d":function(e,t,a){"use strict";a("e590")},1544:function(e,t,a){},1730:function(e,t,a){"use strict";a("84ab")},"1b27":function(e,t,a){"use strict";a("a3e3")},2173:function(e,t,a){"use strict";a("8b01")},3765:function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);var s=a("2b0e"),r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},o=[],i=(a("6b01"),a("2877")),n={},l=Object(i["a"])(n,r,o,!1,null,null,null),c=l.exports,d=a("8c4f"),u=function(){var e=this,t=e._self._c;return t("div",[t("el-container",[t("el-header",[t("img",{staticClass:"mlogo",attrs:{src:"https://www.markerhub.com/dist/images/logo/markerhub-logo.png",alt:""}})]),t("el-main",[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"ç”¨æˆ·å",prop:"username"}},[t("el-input",{model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}})],1),t("el-form-item",{attrs:{label:"å¯†ç ",prop:"password"}},[t("el-input",{attrs:{type:"password"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("ç™»å½•")]),t("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("é‡ç½®")])],1),t("el-form-item",[t("el-link",{attrs:{type:"primary",href:"/register"}},[e._v("æ²¡æœ‰è´¦å·ï¼Ÿç«‹å³æ³¨å†Œ")])],1),t("el-form-item",[t("el-button",{on:{click:e.goHome}},[e._v("è¿”å›žä¸»é¡µ")])],1)],1)],1)],1)],1)},g=[],m=(a("14d9"),{name:"Login",data(){return{ruleForm:{username:"Mrblue",password:"984065220"},rules:{username:[{required:!0,message:"è¯·è¾“å…¥ç”¨æˆ·å",trigger:"blur"},{min:3,max:15,message:"é•¿åº¦åœ¨ 3 åˆ° 15 ä¸ªå­—ç¬¦",trigger:"blur"}],password:[{required:!0,message:"è¯·è¾“å…¥å¯†ç ",trigger:"blur"}]},loading:!1}},methods:{submitForm(e){this.$refs[e].validate(e=>{if(!e)return console.log("ç™»å½•è¡¨å•æ ¡éªŒå¤±è´¥"),!1;this.$axios.post("/login",this.ruleForm).then(e=>{if(200===e.data.code&&e.headers["authorization"]){const t=e.headers["authorization"],a=e.data.data;console.log("ç™»å½•æˆåŠŸï¼Œç”¨æˆ·ä¿¡æ¯:",a),this.$store.commit("SET_TOKEN",t),this.$store.commit("SET_USERINFO",a),a&&"admin"===a.role?(this.$message.success("ç®¡ç†å‘˜ç™»å½•æˆåŠŸï¼æ­£åœ¨è·³è½¬åˆ°ç®¡ç†åŽå°..."),this.$router.push({name:"AdminDashboard"})):(this.$message.success("ç™»å½•æˆåŠŸï¼"),this.$router.push({name:"UserPage"}))}else this.$message.error(e.data.msg||"ç™»å½•å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ‚¨çš„å‡­æ®")}).catch(e=>{var t;console.error("ç™»å½•è¯·æ±‚å¤±è´¥:",e);const a=(null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.msg)||e.message||"ç™»å½•è¯·æ±‚å¼‚å¸¸";this.$message.error(a)})})},resetForm(e){this.$refs[e].resetFields()},goHome(){this.$store.getters.getUser;this.$router.push({name:"UserPage"})}}}),h=m,p=(a("8b9a"),Object(i["a"])(h,u,g,!1,null,"8964a766",null)),f=p.exports,b=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mcontainer"},[t("Header"),t("div",{staticClass:"main-content"},[t("div",{staticClass:"filter-container"},[t("el-input",{staticClass:"search-input",attrs:{placeholder:"ðŸ” æœç´¢åšå®¢æ ‡é¢˜...",clearable:""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.searchQuery,callback:function(t){e.searchQuery=t},expression:"searchQuery"}}),t("el-button",{staticClass:"search-button",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v(" æœç´¢ ")]),t("el-select",{staticClass:"select-box",attrs:{placeholder:"ðŸ“‚ åˆ†ç±»",clearable:""},on:{change:e.handleSearch},model:{value:e.selectedCategory,callback:function(t){e.selectedCategory=t},expression:"selectedCategory"}},e._l(e.categories,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),t("el-select",{staticClass:"select-box",attrs:{placeholder:"ðŸ·ï¸ æ ‡ç­¾",clearable:""},on:{change:e.handleSearch},model:{value:e.selectedTag,callback:function(t){e.selectedTag=t},expression:"selectedTag"}},e._l(e.tags,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),t("el-button",{staticClass:"reset-button",attrs:{type:"warning",icon:"el-icon-refresh-left"},on:{click:e.resetFilters}},[e._v(" é‡ç½® ")])],1),t("el-timeline",e._l(e.blogs,(function(a){return t("el-timeline-item",{key:a.id,attrs:{timestamp:a.created,placement:"top"}},[t("el-card",{staticClass:"blog-card"},[t("h4",[t("router-link",{attrs:{to:{name:"BlogDetail",params:{blogId:a.id}}}},[e._v(" "+e._s(a.title)+" ")])],1),t("p",[e._v(e._s(a.description))]),a.category?t("p",[t("strong",[e._v("åˆ†ç±»ï¼š")]),e._v(" "+e._s(a.category.name)+" ")]):e._e(),a.tags&&a.tags.length>0?t("p",[t("strong",[e._v("æ ‡ç­¾ï¼š")]),e._l(a.tags,(function(s,r){return t("span",{key:s.id},[e._v(" "+e._s(s.name)),r<a.tags.length-1?t("span",[e._v(", ")]):e._e()])}))],2):e._e()])],1)})),1),e.searchMode?e._e():t("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"prev, pager, next","current-page":e.currentPage,"page-size":e.pageSize,total:e.total},on:{"current-change":e.page}})],1)],1)},v=[],y=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m-content"},[t("h3",[e._v("æ¬¢è¿Žæ¥åˆ°Mrblueçš„åšå®¢")]),t("div",{staticClass:"block"},[t("el-avatar",{attrs:{size:50,src:e.avatarUrl}}),t("div",[e._v(e._s(e.user.username))])],1),t("div",{staticClass:"maction"},[t("span",[t("el-link",{attrs:{underline:!1},on:{click:function(t){return e.navigateTo(e.userHomePageLink)}}},[e._v("ä¸»é¡µ")])],1),t("el-divider",{attrs:{direction:"vertical"}}),t("span",[t("el-link",{attrs:{type:"success",underline:!1},on:{click:function(t){return e.navigateTo("/blog/add")}}},[e._v("å‘è¡¨åšå®¢")])],1),t("el-divider",{attrs:{direction:"vertical"}}),e.hasLogin?e._e():t("span",[t("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(t){return e.navigateTo("/login")}}},[e._v("ç™»å½•")])],1),e.hasLogin?t("span",[t("el-link",{attrs:{type:"danger",underline:!1},on:{click:e.logout}},[e._v("é€€å‡º")])],1):e._e()],1)])},w=[],_=a("2f62"),$={name:"Header",computed:{...Object(_["b"])(["getUser","isAdmin"]),user(){return this.getUser||{username:"è¯·å…ˆç™»å½•",avatar:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png"}},hasLogin(){return!!this.$store.state.token&&this.getUser&&"undefined"!==typeof this.getUser.id},avatarUrl(){const e=this.user.avatar;return e&&e.startsWith("/uploads/")?"http://localhost:8081"+e:e||"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png"},userHomePageLink(){return this.hasLogin&&this.isAdmin?{name:"AdminDashboard"}:{name:"UserPage"}}},methods:{logout(){this.$axios.get("/logout").then(e=>{this.$store.commit("REMOVE_INFO"),this.$router.push("/login")}).catch(e=>{console.error("é€€å‡ºæ“ä½œå¼‚å¸¸:",e),this.$store.commit("REMOVE_INFO"),this.$router.push("/login")})},goToAdminDashboard(){this.$router.push({name:"AdminDashboard"})},navigateTo(e){this.$route.path===e||this.$route.name===e.name&&JSON.stringify(this.$route.params)===JSON.stringify(e.params)||("string"===typeof e||"object"===typeof e&&null!==e)&&this.$router.push(e).catch(e=>{"NavigationDuplicated"!==e.name&&console.error(e)})}}},k=$,x=(a("1b27"),Object(i["a"])(k,y,w,!1,null,"1adb83f1",null)),F=x.exports,C={name:"User",components:{Header:F},data(){return{blogs:[],currentPage:1,total:0,pageSize:5,searchQuery:"",searchMode:!1,searchTimeout:null,categories:[],tags:[],selectedCategory:null,selectedTag:null}},methods:{page(e){this.$axios.get("/blogs",{params:{currentPage:e,pageSize:this.pageSize}}).then(e=>{200===e.data.code&&(this.blogs=e.data.data.records,this.currentPage=e.data.data.current,this.total=e.data.data.total,this.pageSize=e.data.data.size,this.searchMode=!1)}).catch(e=>{console.error("Failed to fetch blogs:",e)})},resetFilters(){this.searchQuery="",this.selectedCategory=null,this.selectedTag=null,this.searchMode=!1,this.page(1)},handleSearch(){clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{if(!this.searchQuery.trim()&&!this.selectedCategory&&!this.selectedTag)return this.searchMode=!1,void this.page(1);this.searchMode=!0;const e={};this.searchQuery.trim()&&(e.query=this.searchQuery.trim()),null!==this.selectedCategory&&(e.categoryId=this.selectedCategory),null!==this.selectedTag&&(e.tagId=this.selectedTag),this.$axios.get("/blogs/search",{params:e}).then(e=>{200===e.data.code&&(this.blogs=e.data.data)}).catch(e=>{console.error("Failed to search blogs:",e)})},300)},fetchMetaData(){this.$axios.get("/categories").then(e=>{this.categories=e.data.data}),this.$axios.get("/tags").then(e=>{this.tags=e.data.data})}},created(){this.$store.state.userInfo&&this.page(1),this.fetchMetaData()},beforeUnmount(){clearTimeout(this.searchTimeout)}},S=C,I=(a("2173"),Object(i["a"])(S,b,v,!1,null,"3c227bfd",null)),A=I.exports,L=function(){var e=this,t=e._self._c;return t("div",[t("Header"),t("div",{staticClass:"m-content"},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.pageLoading,expression:"pageLoading"}],staticClass:"form-loading-container",attrs:{"element-loading-text":"æ­£åœ¨åŠ è½½åšå®¢æ•°æ®ï¼Œè¯·ç¨å€™...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.7)"}},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"æ ‡é¢˜",prop:"title"}},[t("el-input",{attrs:{placeholder:"è¯·è¾“å…¥åšå®¢æ ‡é¢˜"},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),t("el-form-item",{attrs:{label:"æ‘˜è¦",prop:"description"}},[t("el-input",{attrs:{type:"textarea",placeholder:"è¯·è¾“å…¥åšå®¢æ‘˜è¦",rows:"3"},model:{value:e.ruleForm.description,callback:function(t){e.$set(e.ruleForm,"description",t)},expression:"ruleForm.description"}})],1),t("el-form-item",{attrs:{label:"åˆ†ç±»",prop:"categoryIds"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",filterable:"",placeholder:"è¯·é€‰æ‹©æˆ–æœç´¢åˆ†ç±»",loading:e.pageLoading},on:{change:e.handleCategoryChange},model:{value:e.ruleForm.categoryIds,callback:function(t){e.$set(e.ruleForm,"categoryIds",t)},expression:"ruleForm.categoryIds"}},e._l(e.categories,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"æ ‡ç­¾",prop:"tagIds"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"è¯·è¾“å…¥æˆ–é€‰æ‹©æ ‡ç­¾ï¼Œå¯åˆ›å»ºæ–°æ ‡ç­¾",loading:e.pageLoading},on:{change:e.handleTagChange},model:{value:e.ruleForm.tagIds,callback:function(t){e.$set(e.ruleForm,"tagIds",t)},expression:"ruleForm.tagIds"}},e._l(e.tags,(function(a){return t("el-option",{key:a.id,attrs:{label:a.name,value:a.id}},[t("span",{style:{color:a.color||"#409EFF"}},[e._v(e._s(a.name))])])})),1)],1),t("el-form-item",{attrs:{label:"å†…å®¹",prop:"content"}},[e.pageLoading&&e.ruleForm.id?t("div",{staticStyle:{"min-height":"500px",display:"flex","align-items":"center","justify-content":"center",border:"1px solid #eee",color:"#999"}},[e._v("å†…å®¹åŠ è½½ä¸­...")]):t("mavon-editor",{ref:"mdEditor",staticStyle:{"min-height":"500px"},attrs:{toolbars:e.toolbars,placeholder:"å¼€å§‹ç¼–å†™ä½ çš„åšå®¢å†…å®¹..."},on:{imgAdd:e.handleImageAdd},model:{value:e.ruleForm.content,callback:function(t){e.$set(e.ruleForm,"content",t)},expression:"ruleForm.content"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v(" "+e._s(e.ruleForm.id?"æ›´æ–°åšå®¢":"å‘å¸ƒåšå®¢")+" ")]),t("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("é‡ç½®å†…å®¹")]),t("el-button",{attrs:{type:"success",loading:e.aiLoading,disabled:e.pageLoading||!e.ruleForm.content||!e.ruleForm.content.trim(),icon:"el-icon-lightbulb"},on:{click:e.getGemmaSuggestions}},[e._v(" èŽ·å–AIå»ºè®® ")])],1)],1)],1),t("el-dialog",{attrs:{title:"AI å†™ä½œå»ºè®® (Gemma 3)",visible:e.dialogVisible,width:"75%",top:"5vh","close-on-click-modal":!1,"append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.aiLoading?t("div",{staticClass:"loading-spinner"},[t("i",{staticClass:"el-icon-loading"}),e._v(" æ­£åœ¨å–åŠ›ç”Ÿæˆå»ºè®®ï¼Œè¯·ç¨å€™... ")]):t("div",{staticClass:"ai-suggestions-content"},[t("mavon-editor",{staticStyle:{"min-height":"45vh",border:"1px solid #dcdfe6","border-radius":"4px"},attrs:{subfield:!1,defaultOpen:"preview",toolbarsFlag:!1,editable:!1,boxShadowStyle:"none",previewBackground:"#f8f9fa"},model:{value:e.suggestions,callback:function(t){e.suggestions=t},expression:"suggestions"}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("å…³é—­")]),t("el-button",{attrs:{type:"primary",disabled:!e.suggestions||e.suggestions.startsWith("èŽ·å–å»ºè®®å¤±è´¥")||e.aiLoading},on:{click:e.applySuggestion}},[e._v("åº”ç”¨å»ºè®®åˆ°æ­£æ–‡")])],1)])],1)],1)},O=[],T=(a("e9f5"),a("910d"),a("f665"),a("ab43"),{name:"BlogEdit",components:{Header:F},data(){return{pageLoading:!1,ruleForm:{id:null,title:"",description:"",content:"",categoryIds:[],tagIds:[]},categories:[],tags:[],rules:{title:[{required:!0,message:"è¯·è¾“å…¥æ ‡é¢˜",trigger:"blur"},{min:3,max:100,message:"é•¿åº¦åœ¨ 3 åˆ° 100 ä¸ªå­—ç¬¦",trigger:"blur"}],description:[{required:!0,message:"è¯·è¾“å…¥æ‘˜è¦",trigger:"blur"},{max:255,message:"æ‘˜è¦é•¿åº¦ä¸èƒ½è¶…è¿‡ 255 ä¸ªå­—ç¬¦",trigger:"blur"}],content:[{required:!0,message:"è¯·è¾“å…¥å†…å®¹",trigger:"blur"}]},suggestions:"",aiLoading:!1,submitLoading:!1,dialogVisible:!1,toolbars:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!0,code:!0,table:!0,fullscreen:!0,readmodel:!0,htmlcode:!0,help:!0,undo:!0,redo:!0,trash:!0,save:!1,navigation:!0,alignleft:!0,aligncenter:!0,alignright:!0,subfield:!0,preview:!0}}},computed:{...Object(_["b"])(["getUser","isAdmin"])},methods:{handleImageAdd(e,t){const a=new FormData;a.append("image",t),this.$axios.post("/api/upload/image",a,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{200===t.data.code&&t.data.data&&t.data.data.url?(this.$refs.mdEditor.$img2Url(e,t.data.data.url),this.$message.success("å›¾ç‰‡ä¸Šä¼ æˆåŠŸ")):(this.$message.error(t.data.msg||"å›¾ç‰‡ä¸Šä¼ å¤±è´¥"),this.$refs.mdEditor.$refs.toolbar_left.$imgDel(e))}).catch(t=>{console.error("å›¾ç‰‡ä¸Šä¼ é”™è¯¯:",t.response||t),this.$message.error("å›¾ç‰‡ä¸Šä¼ è¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–è”ç³»ç®¡ç†å‘˜"),this.$refs.mdEditor.$refs.toolbar_left.$imgDel(e)})},handleCategoryChange(e){},submitForm(e){this.$refs[e].validate(e=>{if(!e)return console.log("è¡¨å•æ ¡éªŒå¤±è´¥!!"),this.$message.error("è¯·æ£€æŸ¥è¡¨å•å¡«å†™æ˜¯å¦å®Œæ•´ä¸”æ­£ç¡®"),!1;this.submitLoading=!0,this.$axios.post("/blog/edit",this.ruleForm).then(e=>{200===e.data.code?(this.$message.success(this.ruleForm.id?"åšå®¢æ›´æ–°æˆåŠŸï¼":"åšå®¢å‘å¸ƒæˆåŠŸï¼"),this.isAdmin?this.$router.push({name:"AdminBlogManagement"}):this.$router.push({name:"UserPage"})):this.$message.error(e.data.msg||"æ“ä½œå¤±è´¥")}).catch(e=>{var t;console.error("æäº¤åšå®¢å¤±è´¥:",e.response||e),this.$message.error((null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.msg)||"æäº¤å¤±è´¥ï¼Œè¯·ç¨åŽå†è¯•")}).finally(()=>{this.submitLoading=!1})})},async handleTagChange(e){const t=e.filter(e=>"string"===typeof e),a=e.filter(e=>"string"!==typeof e);if(t.length>0){const e=t.map(async e=>{try{const t=await this.$axios.post("/tags/create",{name:e});if(200===t.data.code&&t.data.data){const e=t.data.data;return this.tags.find(t=>t.id===e.id)||this.tags.push(e),e.id}return this.$message.error(`åˆ›å»ºæ ‡ç­¾ "${e}" å¤±è´¥: ${t.data.msg||"æœªçŸ¥é”™è¯¯"}`),null}catch(t){return console.error(`åˆ›å»ºæ ‡ç­¾ "${e}" å¤±è´¥:`,t.response||t),this.$message.error(`åˆ›å»ºæ ‡ç­¾ "${e}" æ—¶å‘ç”Ÿç½‘ç»œé”™è¯¯`),null}}),s=(await Promise.all(e)).filter(e=>null!==e);this.ruleForm.tagIds=[...a,...s]}else this.ruleForm.tagIds=a},resetForm(e){this.$refs[e].resetFields(),this.ruleForm.id=null,this.ruleForm.categoryIds=[],this.ruleForm.tagIds=[],this.ruleForm.content=""},async getGemmaSuggestions(){if(this.ruleForm.content&&this.ruleForm.content.trim()){this.aiLoading=!0,this.dialogVisible=!0,this.suggestions="";try{const e=await this.$axios.post("/api/ai/ask",{prompt:"è¯·é’ˆå¯¹ä»¥ä¸‹åšå®¢å†…å®¹æä¾›å†™ä½œå»ºè®®ã€æ”¹è¿›ç‚¹æˆ–ç›¸å…³è¡¥å……ä¿¡æ¯ï¼Œä½¿å…¶æ›´å®Œå–„å’Œå¸å¼•äººï¼ˆè¯·ç›´æŽ¥è¿”å›žå»ºè®®å†…å®¹ï¼Œä¸è¦åŒ…å«å…¶ä»–é¢å¤–è¯´æ˜Žï¼‰ï¼š\n\n"+this.ruleForm.content});200===e.data.code&&e.data.data?this.suggestions=e.data.data:this.suggestions="èŽ·å–å»ºè®®å¤±è´¥: "+(e.data.msg||"AIæœåŠ¡æœªè¿”å›žæœ‰æ•ˆå»ºè®®")}catch(t){var e;console.error("èŽ·å–AIå»ºè®®å¤±è´¥:",t.response||t);let a=(null===(e=t.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.msg)||t.message||"æœªçŸ¥é”™è¯¯";t.message&&t.message.toLowerCase().includes("timeout")&&(a="è¯·æ±‚AIæœåŠ¡è¶…æ—¶ï¼Œè¯·ç¨åŽå†è¯•"),this.suggestions="èŽ·å–å»ºè®®å¤±è´¥: "+a}finally{this.aiLoading=!1}}else this.$message.warning("è¯·è¾“å…¥ä¸€äº›å†…å®¹ä»¥èŽ·å–AIå»ºè®®")},applySuggestion(){this.suggestions&&!this.suggestions.startsWith("èŽ·å–å»ºè®®å¤±è´¥")&&(this.ruleForm.content+="\n\n---\n**AI å»ºè®®å‚è€ƒ:**\n"+this.suggestions,this.$message.success("å»ºè®®å·²æ·»åŠ åˆ°ç¼–è¾‘åŒºæœ«å°¾")),this.dialogVisible=!1},async fetchInitialData(){this.pageLoading=!0;try{const[e,t]=await Promise.all([this.$axios.get("/categories"),this.$axios.get("/tags")]);200===e.data.code?this.categories=e.data.data||[]:this.$message.error(e.data.msg||"åŠ è½½åˆ†ç±»åˆ—è¡¨å¤±è´¥"),200===t.data.code?this.tags=t.data.data||[]:this.$message.error(t.data.msg||"åŠ è½½æ ‡ç­¾åˆ—è¡¨å¤±è´¥");const a=this.$route.params.blogId;if(a){const e=await this.$axios.get("/blog/"+a);if(200===e.data.code&&e.data.data){const t=e.data.data;this.ruleForm={id:t.id,title:t.title||"",description:t.description||"",content:t.content||"",categoryIds:t.categoryIds||(t.categories?t.categories.map(e=>e.id):[]),tagIds:t.tagIds||(t.tags?t.tags.map(e=>e.id):[])}}else this.$message.error(e.data.msg||"åŠ è½½åšå®¢å†…å®¹å¤±è´¥"),this.$router.push({name:this.isAdmin?"AdminBlogManagement":"UserPage"})}else this.ruleForm={id:null,title:"",description:"",content:"",categoryIds:[],tagIds:[]}}catch(e){console.error("Error during initial data fetch for BlogEdit:",e.response||e),this.$message.error("åŠ è½½ç¼–è¾‘é¡µé¢åˆå§‹æ•°æ®æ—¶å‘ç”Ÿç½‘ç»œé”™è¯¯")}finally{this.pageLoading=!1}}},created(){this.fetchInitialData()}}),P=T,D=(a("1730"),Object(i["a"])(P,L,O,!1,null,"17a46f5e",null)),U=D.exports,B=function(){var e=this,t=e._self._c;return t("div",[t("Header"),!e.loading&&e.blog.id?t("div",{staticClass:"mblog"},[t("h1",[e._v(e._s(e.blog.title))]),t("h2",{staticClass:"blog-description"},[e._v(e._s(e.blog.description))]),t("div",{staticClass:"actions-bar"},[e.canEdit?t("el-link",{staticClass:"action-link",attrs:{icon:"el-icon-edit"}},[t("router-link",{attrs:{to:{name:"BlogEdit",params:{blogId:e.blog.id}}}},[e._v(" ç¼–è¾‘ ")])],1):e._e(),e.canDelete?t("el-link",{staticClass:"action-link",attrs:{icon:"el-icon-delete",type:"danger"},on:{click:e.confirmDeleteBlog}},[e._v(" åˆ é™¤ ")]):e._e()],1),t("div",{staticClass:"meta-info"},[e.blog.categories&&e.blog.categories.length>0?t("div",{staticClass:"category-box"},[t("span",{staticClass:"meta-title"},[e._v("ðŸ“‚ åˆ†ç±»ï¼š")]),e._l(e.blog.categories,(function(a){return t("el-tag",{key:"c-"+a.id,staticClass:"meta-tag",attrs:{type:"success"}},[e._v(" "+e._s(a.name)+" ")])}))],2):t("div",{staticClass:"category-box"},[t("span",{staticClass:"meta-title"},[e._v("ðŸ“‚ åˆ†ç±»ï¼š")]),t("el-tag",{staticClass:"meta-tag",attrs:{type:"info"}},[e._v("æš‚æ— åˆ†ç±»")])],1),e.blog.tags&&e.blog.tags.length>0?t("div",{staticClass:"tag-box"},[t("span",{staticClass:"meta-title"},[e._v("ðŸ·ï¸ æ ‡ç­¾ï¼š")]),e._l(e.blog.tags,(function(a){return t("el-tag",{key:"t-"+a.id,staticClass:"meta-tag tag",attrs:{color:a.color||"#409EFF",effect:"dark"}},[e._v(" "+e._s(a.name)+" ")])}))],2):t("div",{staticClass:"tag-box"},[t("span",{staticClass:"meta-title"},[e._v("ðŸ·ï¸ æ ‡ç­¾ï¼š")]),t("el-tag",{staticClass:"meta-tag",attrs:{type:"info"}},[e._v("æš‚æ— æ ‡ç­¾")])],1)]),t("el-divider"),t("div",{staticClass:"markdown-body",domProps:{innerHTML:e._s(e.blog.content)}})],1):e._e(),e.loading?t("div",{staticClass:"loading-placeholder"},[t("i",{staticClass:"el-icon-loading"}),e._v(" åšå®¢å†…å®¹åŠ è½½ä¸­... ")]):e._e(),e.loading||e.blog.id?e._e():t("div",{staticClass:"not-found-placeholder"},[t("p",[e._v("æœªèƒ½åŠ è½½åšå®¢å†…å®¹ï¼Œæˆ–è¯¥åšå®¢ä¸å­˜åœ¨ã€‚")]),t("el-button",{attrs:{type:"primary"},on:{click:e.goBack}},[e._v("è¿”å›žåˆ—è¡¨")])],1)],1)},q=[],E=a("d4cd"),N=a.n(E),j={name:"BlogDetail",components:{Header:F},data(){return{blog:{id:null,title:"åŠ è½½ä¸­...",description:"",content:"",userId:null,categories:[],tags:[]},loading:!0}},computed:{...Object(_["b"])(["getUser","isAdmin"]),isOwner(){return this.getUser&&this.blog&&this.blog.userId===this.getUser.id},canEdit(){return this.isOwner},canDelete(){return this.isOwner||this.isAdmin}},created(){this.fetchBlogDetail()},watch:{"$route.params.blogId":function(e,t){e&&e!==t&&this.fetchBlogDetail()}},methods:{fetchBlogDetail(){this.loading=!0;const e=this.$route.params.blogId;if(!e)return this.$message.error("æ— æ•ˆçš„åšå®¢ID"),this.loading=!1,void this.$router.push({name:"UserPage"});this.$axios.get("/blog/"+e).then(e=>{if(200===e.data.code&&e.data.data){const t=e.data.data;if(this.blog.id=t.id,this.blog.title=t.title||"æ— æ ‡é¢˜",this.blog.description=t.description||"",this.blog.userId=t.userId,this.blog.categories=t.categories||[],this.blog.tags=t.tags||[],t.content){const e=new N.a({html:!0,breaks:!0,linkify:!0}),a="http://localhost:8081",s=e.renderer.rules.image;e.renderer.rules.image=(e,t,r,o,i)=>{const n=e[t],l=n.attrIndex("src");let c=n.attrs[l][1];return c&&c.startsWith("/uploads/")&&(n.attrs[l][1]=a+c),s(e,t,r,o,i)},this.blog.content=e.render(t.content)}else this.blog.content="<p style='text-align:center; color:#999;'>æš‚æ— å†…å®¹</p>"}else this.$message.error(e.data.msg||"åŠ è½½åšå®¢è¯¦æƒ…å¤±è´¥"),this.blog.id=null}).catch(e=>{var t;console.error("åŠ è½½åšå®¢è¯¦æƒ…è¯·æ±‚å¤±è´¥:",e.response||e),this.$message.error((null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.msg)||"åŠ è½½åšå®¢è¯¦æƒ…æ—¶å‘ç”Ÿç½‘ç»œé”™è¯¯"),this.blog.id=null}).finally(()=>{this.loading=!1})},confirmDeleteBlog(){this.$confirm(`ç¡®å®šè¦æ°¸ä¹…åˆ é™¤åšå®¢ã€Š${this.blog.title}ã€‹å—? æ­¤æ“ä½œä¸å¯æ¢å¤ã€‚`,"è­¦å‘Šï¼šåˆ é™¤åšå®¢",{confirmButtonText:"ç¡®å®šåˆ é™¤",cancelButtonText:"å–æ¶ˆ",type:"warning",center:!0}).then(()=>{this.deleteBlog()}).catch(()=>{})},deleteBlog(){this.blog.id&&this.$axios.delete("/blog/"+this.blog.id).then(e=>{200===e.data.code?(this.$message.success("åšå®¢åˆ é™¤æˆåŠŸï¼"),this.isAdmin?this.$router.push({name:"AdminBlogManagement"}):this.$router.push({name:"UserPage"})):this.$message.error(e.data.msg||"åˆ é™¤å¤±è´¥")}).catch(e=>{var t;console.error("åˆ é™¤åšå®¢è¯·æ±‚å¤±è´¥:",e.response||e),this.$message.error((null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.msg)||"åˆ é™¤åšå®¢æ—¶å‘ç”Ÿç½‘ç»œé”™è¯¯")})},goBack(){this.isAdmin?this.$router.push({name:"AdminBlogManagement"}):this.$router.push({name:"UserPage"})}}},z=j,M=(a("746c"),Object(i["a"])(z,B,q,!1,null,"d4b328ae",null)),R=M.exports,K=function(){var e=this,t=e._self._c;return t("div",[t("el-container",[t("el-header",[t("img",{staticClass:"mlogo",attrs:{src:"https://www.markerhub.com/dist/images/logo/markerhub-logo.png",alt:""}})]),t("el-main",[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"ç”¨æˆ·å",prop:"username"}},[t("el-input",{model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}})],1),t("el-form-item",{attrs:{label:"å¯†ç ",prop:"password"}},[t("el-input",{attrs:{type:"password"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),t("el-form-item",{attrs:{label:"é‚®ç®±",prop:"email"}},[t("el-input",{model:{value:e.ruleForm.email,callback:function(t){e.$set(e.ruleForm,"email",t)},expression:"ruleForm.email"}})],1),t("el-form-item",{attrs:{label:"æ³¨å†Œèº«ä»½",prop:"role"}},[t("el-select",{attrs:{placeholder:"è¯·é€‰æ‹©èº«ä»½"},model:{value:e.ruleForm.role,callback:function(t){e.$set(e.ruleForm,"role",t)},expression:"ruleForm.role"}},[t("el-option",{attrs:{label:"æ™®é€šç”¨æˆ·",value:"user"}}),t("el-option",{attrs:{label:"ç®¡ç†å‘˜",value:"admin"}})],1)],1),t("el-form-item",{attrs:{label:"å¤´åƒ",prop:"avatar"}},[t("input",{attrs:{type:"file"},on:{change:e.handleFileUpload}})]),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("æ³¨å†Œ")]),t("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("é‡ç½®")])],1),t("el-form-item",[t("el-link",{attrs:{type:"primary",href:"/login"}},[e._v("å·²æœ‰è´¦å·ï¼Ÿç«‹å³ç™»å½•")])],1),t("el-form-item",[t("el-button",{on:{click:e.goHome}},[e._v("è¿”å›žä¸»é¡µ")])],1)],1)],1)],1)],1)},H=[],J={name:"Register",data(){return{ruleForm:{username:"",password:"",email:"",role:"user",avatar:null},rules:{username:[{required:!0,message:"è¯·è¾“å…¥ç”¨æˆ·å",trigger:"blur"},{min:3,max:15,message:"é•¿åº¦åœ¨ 3 åˆ° 15 ä¸ªå­—ç¬¦",trigger:"blur"}],password:[{required:!0,message:"è¯·è¾“å…¥å¯†ç ",trigger:"blur"}],email:[{required:!0,message:"è¯·è¾“å…¥é‚®ç®±",trigger:"blur"},{type:"email",message:"é‚®ç®±æ ¼å¼ä¸æ­£ç¡®",trigger:["blur","change"]}],role:[{required:!0,message:"è¯·é€‰æ‹©æ³¨å†Œèº«ä»½",trigger:"change"}]}}},methods:{handleFileUpload(e){this.ruleForm.avatar=e.target.files[0]},submitForm(e){this.$refs[e].validate(e=>{if(!e)return console.log("error submit!!"),!1;{const e=new FormData;e.append("username",this.ruleForm.username),e.append("password",this.ruleForm.password),e.append("email",this.ruleForm.email),e.append("role",this.ruleForm.role),this.ruleForm.avatar&&e.append("avatar",this.ruleForm.avatar),this.$axios.post("/register",e,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{200===e.data.code?this.$alert("æ³¨å†ŒæˆåŠŸ","æç¤º",{confirmButtonText:"ç¡®å®š",callback:e=>{this.$router.push("/login")}}):this.$message.error(e.data.msg||"æ³¨å†Œå¤±è´¥")}).catch(e=>{var t;const a=(null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.msg)||e.message||"æ³¨å†Œè¯·æ±‚å¤±è´¥";this.$message.error(a)})}})},resetForm(e){this.$refs[e].resetFields(),this.ruleForm.avatar=null,this.ruleForm.role="user";const t=this.$el.querySelector('input[type="file"]');t&&(t.value="")},goHome(){this.$router.push("/")}}},V=J,Q=(a("e792"),Object(i["a"])(V,K,H,!1,null,"6fec3c54",null)),G=Q.exports,W=function(){var e=this,t=e._self._c;return t("div",{staticClass:"admin-dashboard-page"},[t("Header"),t("div",{staticClass:"admin-dashboard-container"},[t("h1",[e._v("ç®¡ç†å‘˜æŽ§åˆ¶å°")]),e.getUser?t("p",[e._v("æ¬¢è¿Žæ‚¨ï¼Œç®¡ç†å‘˜ "),t("strong",[e._v(e._s(e.adminUsername))]),e._v("ï¼")]):t("p",[e._v("æ­£åœ¨åŠ è½½ç”¨æˆ·ä¿¡æ¯...")]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{xs:24,sm:12,md:8}},[t("el-card",{staticClass:"dashboard-card",attrs:{shadow:"hover"},nativeOn:{click:function(t){return e.navigateTo({name:"AdminKeywords"})}}},[t("div",{staticClass:"card-content"},[t("i",{staticClass:"el-icon-key card-icon"}),t("h3",[e._v("å…³é”®å­—ç®¡ç†")]),t("p",[e._v("æ·»åŠ ã€åˆ é™¤å’ŒæŸ¥çœ‹å†…å®¹è¿‡æ»¤å…³é”®å­—ã€‚")])])])],1),t("el-col",{attrs:{xs:24,sm:12,md:8}},[t("el-card",{staticClass:"dashboard-card",attrs:{shadow:"hover"},nativeOn:{click:function(t){return e.navigateTo({name:"AdminBlogManagement"})}}},[t("div",{staticClass:"card-content"},[t("i",{staticClass:"el-icon-document-copy card-icon",staticStyle:{color:"#E6A23C"}}),t("h3",[e._v("åšå®¢ç®¡ç†")]),e._v(" "),t("p",[e._v("æŸ¥çœ‹ã€æœç´¢å’Œåˆ é™¤æ‰€æœ‰ç”¨æˆ·å‘å¸ƒçš„åšå®¢ã€‚")])])])],1)],1)],1),t("p",{staticStyle:{"text-align":"center",color:"#ccc","margin-top":"20px"}},[e._v("-- ç®¡ç†ä»ªè¡¨ç›˜åº•éƒ¨ --")])],1)},X=[],Y={name:"AdminDashboard",components:{Header:F},computed:{...Object(_["b"])(["getUser"]),adminUsername(){return this.getUser?this.getUser.username:"ç®¡ç†å‘˜"}},methods:{navigateTo(e){let t=!1;const a=this.$route;"string"===typeof e?t=a.path===e:"object"===typeof e&&null!==e&&(e.name?t=a.name===e.name&&JSON.stringify(a.params)===JSON.stringify(e.params||{})&&JSON.stringify(a.query)===JSON.stringify(e.query||{}):e.path&&(t=a.path===e.path&&JSON.stringify(a.query)===JSON.stringify(e.query||{}))),t?console.log("Already on the target route or navigating to the same route."):this.$router.push(e).catch(e=>{"NavigationDuplicated"!==e.name&&console.error("Router navigation error:",e)})}},created(){console.log("AdminDashboard component created.")},mounted(){console.log("AdminDashboard component mounted.")}},Z=Y,ee=(a("ae4a"),Object(i["a"])(Z,W,X,!1,null,"02116d2b",null)),te=ee.exports,ae=function(){var e=this,t=e._self._c;return t("div",[t("Header"),t("div",{staticClass:"admin-keywords-container"},[t("el-breadcrumb",{staticStyle:{"margin-bottom":"20px"},attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"AdminDashboard"}}},[e._v("ç®¡ç†åŽå°")]),t("el-breadcrumb-item",[e._v("å…³é”®å­—ç®¡ç†")])],1),t("h2",[e._v("å…³é”®å­—ç®¡ç†")]),t("p",[e._v("ç®¡ç†ç³»ç»Ÿä¸­ç”¨äºŽå†…å®¹è¿‡æ»¤çš„è¿ç¦è¯æˆ–æ•æ„Ÿè¯æ±‡ã€‚")]),t("el-form",{staticClass:"keyword-form",attrs:{inline:!0},nativeOn:{submit:function(t){return t.preventDefault(),e.handleAddKeyword.apply(null,arguments)}}},[t("el-form-item",{attrs:{label:"æ–°å…³é”®å­—"}},[t("el-input",{attrs:{placeholder:"è¾“å…¥è¿ç¦è¯",clearable:""},model:{value:e.newKeywordText,callback:function(t){e.newKeywordText=t},expression:"newKeywordText"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary","native-type":"submit",loading:e.addLoading,icon:"el-icon-plus"}},[e._v("æ·»åŠ ")])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticClass:"keywords-table",staticStyle:{width:"100%"},attrs:{data:e.keywordsList,border:"",stripe:"","empty-text":"æš‚æ— å…³é”®å­—æ•°æ®"}},[t("el-table-column",{attrs:{prop:"id",label:"ID",width:"100",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"keyword",label:"å…³é”®å­—","min-width":"200","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"created",label:"åˆ›å»ºæ—¶é—´",width:"180",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatDateTime(t.row.created))+" ")]}}])}),t("el-table-column",{attrs:{label:"æ“ä½œ",width:"100",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"danger",loading:a.row.deleteLoading,icon:"el-icon-delete",title:"åˆ é™¤å…³é”®å­—"},on:{click:function(t){return e.handleDeleteKeyword(a.row.id,a.row.keyword)}}})]}}])})],1)],1)],1)},se=[],re={components:{Header:F},name:"AdminKeywords",data(){return{newKeywordText:"",keywordsList:[],listLoading:!1,addLoading:!1}},created(){console.log("AdminKeywords component CREATED"),this.fetchKeywords()},methods:{formatDateTime(e){if(!e)return"N/A";try{const t=new Date(e);return isNaN(t.getTime())?"æ— æ•ˆæ—¥æœŸ":t.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}catch(t){return e}},fetchKeywords(){this.listLoading=!0,this.$axios.get("/admin/keywords/list").then(e=>{200===e.data.code?this.keywordsList=e.data.data.map(e=>({...e,deleteLoading:!1})):this.$message.error(e.data.msg||"èŽ·å–å…³é”®å­—åˆ—è¡¨å¤±è´¥")}).catch(e=>{var t;console.error("èŽ·å–å…³é”®å­—åˆ—è¡¨è¯·æ±‚å¤±è´¥:",e.response||e.message),this.$message.error((null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.msg)||"èŽ·å–å…³é”®å­—åˆ—è¡¨è¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–è”ç³»ç®¡ç†å‘˜")}).finally(()=>{this.listLoading=!1})},handleAddKeyword(){this.newKeywordText.trim()?(this.addLoading=!0,this.$axios.post("/admin/keywords/add",{keyword:this.newKeywordText.trim()}).then(e=>{200===e.data.code?(this.$message.success("å…³é”®å­—æ·»åŠ æˆåŠŸ"),this.newKeywordText="",this.fetchKeywords()):this.$message.error(e.data.msg||"æ·»åŠ å…³é”®å­—å¤±è´¥")}).catch(e=>{var t;console.error("æ·»åŠ å…³é”®å­—è¯·æ±‚å¤±è´¥:",e.response||e.message),this.$message.error((null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.msg)||"æ·»åŠ å…³é”®å­—è¯·æ±‚å¤±è´¥")}).finally(()=>{this.addLoading=!1})):this.$message.warning("å…³é”®å­—ä¸èƒ½ä¸ºç©º")},handleDeleteKeyword(e,t){this.$confirm(`ç¡®å®šè¦æ°¸ä¹…åˆ é™¤å…³é”®å­—â€œ${t||"æ­¤å…³é”®å­—"}â€å—?`,"è­¦å‘Šï¼šåˆ é™¤å…³é”®å­—",{confirmButtonText:"ç¡®å®šåˆ é™¤",cancelButtonText:"å–æ¶ˆ",type:"warning"}).then(()=>{const t=this.keywordsList.findIndex(t=>t.id===e);-1!==t&&this.$set(this.keywordsList[t],"deleteLoading",!0),this.$axios.delete("/admin/keywords/delete/"+e).then(e=>{200===e.data.code?(this.$message.success("å…³é”®å­—åˆ é™¤æˆåŠŸ"),this.fetchKeywords()):(this.$message.error(e.data.msg||"åˆ é™¤å…³é”®å­—å¤±è´¥"),-1!==t&&this.$set(this.keywordsList[t],"deleteLoading",!1))}).catch(e=>{var a;console.error("åˆ é™¤å…³é”®å­—è¯·æ±‚å¤±è´¥:",e.response||e.message),this.$message.error((null===(a=e.response)||void 0===a||null===(a=a.data)||void 0===a?void 0:a.msg)||"åˆ é™¤å…³é”®å­—è¯·æ±‚å¤±è´¥"),-1!==t&&this.$set(this.keywordsList[t],"deleteLoading",!1)})}).catch(()=>{this.$message.info("å·²å–æ¶ˆåˆ é™¤æ“ä½œ")})}}},oe=re,ie=(a("82a3"),Object(i["a"])(oe,ae,se,!1,null,"bff99464",null)),ne=ie.exports,le=function(){var e=this,t=e._self._c;return t("div",{staticClass:"admin-blog-management-page"},[t("Header"),t("div",{staticClass:"page-container"},[t("el-breadcrumb",{staticStyle:{"margin-bottom":"20px"},attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"AdminDashboard"}}},[e._v("ç®¡ç†åŽå°")]),t("el-breadcrumb-item",[e._v("åšå®¢ç®¡ç†")])],1),t("h2",[e._v("æ‰€æœ‰åšå®¢åˆ—è¡¨")]),t("p",[e._v("åœ¨è¿™é‡Œæ‚¨å¯ä»¥æŸ¥çœ‹ã€æœç´¢å¹¶ç®¡ç†ç³»ç»Ÿä¸­æ‰€æœ‰ç”¨æˆ·å‘å¸ƒçš„åšå®¢ã€‚")]),t("el-form",{staticClass:"search-form",attrs:{inline:!0,model:e.filters},nativeOn:{submit:function(t){return t.preventDefault(),e.handleSearch.apply(null,arguments)}}},[t("el-form-item",{attrs:{label:"æ ‡é¢˜æœç´¢"}},[t("el-input",{attrs:{placeholder:"è¾“å…¥åšå®¢æ ‡é¢˜å…³é”®å­—",clearable:""},on:{clear:e.handleSearch},model:{value:e.filters.query,callback:function(t){e.$set(e.filters,"query",t)},expression:"filters.query"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("æœç´¢")]),t("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.resetSearch}},[e._v("é‡ç½®")])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.blogs,border:"",stripe:"","empty-text":"æš‚æ— åšå®¢æ•°æ®"}},[t("el-table-column",{attrs:{prop:"id",label:"ID",width:"80",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"title",label:"æ ‡é¢˜","min-width":"250","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-link",{attrs:{type:"primary",title:"æŸ¥çœ‹åšå®¢è¯¦æƒ…"},on:{click:function(t){return e.viewBlog(a.row.id)}}},[e._v(e._s(a.row.title))])]}}])}),t("el-table-column",{attrs:{label:"ä½œè€…ä¿¡æ¯",width:"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",[e._v("ID: "+e._s(a.row.userId))])]}}])}),t("el-table-column",{attrs:{prop:"created",label:"å‘å¸ƒæ—¶é—´",width:"170",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatDateTime(t.row.created))+" ")]}}])}),t("el-table-column",{attrs:{prop:"status",label:"çŠ¶æ€",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:0===a.row.status?"success":"info"}},[e._v(" "+e._s(0===a.row.status?"å·²å‘å¸ƒ":"è‰ç¨¿")+" ")])]}}])}),t("el-table-column",{attrs:{label:"æ“ä½œ",width:"100",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete",loading:a.row.deleteLoading,title:"åˆ é™¤åšå®¢"},on:{click:function(t){return e.handleDelete(a.row.id,a.row.title)}}})]}}])})],1),e.totalBlogs>0?t("el-pagination",{staticStyle:{"margin-top":"20px","text-align":"right"},attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":e.currentPage,"page-size":e.pageSize,"page-sizes":[10,20,50,100],total:e.totalBlogs},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handlePageChange}}):e._e()],1)],1)},ce=[],de=(a("7d54"),{name:"AdminBlogManagement",components:{Header:F},data(){return{blogs:[],loading:!1,currentPage:1,pageSize:10,totalBlogs:0,filters:{query:""}}},created(){this.fetchBlogs()},methods:{fetchBlogs(){this.loading=!0;const e={currentPage:this.currentPage,pageSize:this.pageSize,query:this.filters.query.trim()};Object.keys(e).forEach(t=>{""!==e[t]&&null!==e[t]&&void 0!==e[t]||delete e[t]}),this.$axios.get("/admin/blogs/all",{params:e}).then(e=>{if(200===e.data.code){const t=e.data.data;this.blogs=t.records.map(e=>({...e,deleteLoading:!1})),this.totalBlogs=t.total}else this.$message.error(e.data.msg||"èŽ·å–åšå®¢åˆ—è¡¨å¤±è´¥")}).catch(e=>{var t;console.error("èŽ·å–åšå®¢åˆ—è¡¨å¤±è´¥:",e),this.$message.error((null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.msg)||"è¯·æ±‚åšå®¢åˆ—è¡¨å¤±è´¥")}).finally(()=>{this.loading=!1})},formatDateTime(e){if(!e)return"N/A";try{const t=new Date(e);return isNaN(t.getTime())?"æ— æ•ˆæ—¥æœŸ":t.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}catch(t){return e}},viewBlog(e){this.$router.push({name:"BlogDetail",params:{blogId:e}})},handleDelete(e,t){this.$confirm(`ç¡®å®šè¦æ°¸ä¹…åˆ é™¤åšå®¢ã€Š${t||"æ­¤åšå®¢"}ã€‹å—? æ­¤æ“ä½œä¸å¯æ¢å¤ã€‚`,"è­¦å‘Šï¼šåˆ é™¤åšå®¢",{confirmButtonText:"ç¡®å®šåˆ é™¤",cancelButtonText:"å–æ¶ˆ",type:"warning"}).then(()=>{const t=this.blogs.findIndex(t=>t.id===e);-1!==t&&this.$set(this.blogs[t],"deleteLoading",!0),this.$axios.delete("/blog/"+e).then(e=>{200===e.data.code?(this.$message.success("åšå®¢åˆ é™¤æˆåŠŸ"),1===this.blogs.length&&this.currentPage>1&&this.currentPage--,this.fetchBlogs()):this.$message.error(e.data.msg||"åˆ é™¤åšå®¢å¤±è´¥")}).catch(e=>{var t;console.error("åˆ é™¤åšå®¢è¯·æ±‚å¤±è´¥:",e),this.$message.error((null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.msg)||"è¯·æ±‚åˆ é™¤åšå®¢å¤±è´¥")}).finally(()=>{-1!==t&&this.blogs[t]&&this.$set(this.blogs[t],"deleteLoading",!1)})}).catch(()=>{})},handlePageChange(e){this.currentPage=e,this.fetchBlogs()},handleSizeChange(e){this.pageSize=e,this.currentPage=1,this.fetchBlogs()},handleSearch(){this.currentPage=1,this.fetchBlogs()},resetSearch(){this.filters.query="",this.currentPage=1,this.fetchBlogs()}}}),ue=de,ge=(a("059d"),Object(i["a"])(ue,le,ce,!1,null,"7566826a",null)),me=ge.exports;s["default"].use(d["a"]);const he=[{path:"/",name:"Index",redirect:{name:"UserPage"}},{path:"/user",name:"UserPage",component:A,meta:{requireAuth:!0}},{path:"/login",name:"Login",component:f},{path:"/blog/add",name:"BlogAdd",component:U,meta:{requireAuth:!0}},{path:"/blog/:blogId",name:"BlogDetail",component:R},{path:"/blog/:blogId/edit",name:"BlogEdit",component:U,meta:{requireAuth:!0}},{path:"/register",name:"Register",component:G},{path:"/dashboard",name:"AdminDashboard",component:te,meta:{requireAuth:!0,requireAdmin:!0}},{path:"/admin/keywords",name:"AdminKeywords",component:ne,meta:{requireAuth:!0,requireAdmin:!0}},{path:"/admin/blogs",name:"AdminBlogManagement",component:me,meta:{requireAuth:!0,requireAdmin:!0,title:"åšå®¢ç®¡ç†"}}],pe=new d["a"]({mode:"history",base:"/",routes:he});var fe=pe;s["default"].use(_["a"]);var be=new _["a"].Store({state:{token:"",userInfo:JSON.parse(sessionStorage.getItem("userInfo"))},mutations:{SET_TOKEN:(e,t)=>{e.token=t,localStorage.setItem("token",t)},SET_USERINFO:(e,t)=>{e.userInfo=t,sessionStorage.setItem("userInfo",JSON.stringify(t))},REMOVE_INFO:e=>{e.token="",e.userInfo={},localStorage.setItem("token",""),sessionStorage.setItem("userInfo",JSON.stringify(""))}},getters:{getUser:e=>e.userInfo,isAdmin:e=>e.userInfo&&"admin"===e.userInfo.role},actions:{},modules:{}}),ve=a("5c96"),ye=a.n(ve),we=a("bc3a"),_e=a.n(we),$e=a("b2d8"),ke=a.n($e);a("0fae"),a("64e1");_e.a.defaults.baseURL="http://localhost:8081",_e.a.interceptors.request.use(e=>(localStorage.getItem("token")&&(e.headers.Authorization=localStorage.getItem("token")),e),e=>Promise.reject(e)),_e.a.interceptors.response.use(e=>e,e=>(401===e.response.status&&(localStorage.removeItem("token"),fe.push("/login")),Promise.reject(e)),e=>(console.log(e),e.response.data&&(e.message=e.response.data.msg),401===e.response.status&&(be.commit("REMOVE_INFO"),localStorage.removeItem("token"),fe.push("/login")),ye.a.Message.error(e.message,{duration:3e3}),Promise.reject(e)));_e.a,a("a732");fe.beforeEach((e,t,a)=>{console.log(`Navigating from: ${t.path} to: ${e.path}`);const s=be.state.token,r=be.getters.getUser;console.log("Permission Guard Check:",{tokenExists:!!s,userInfo:r,targetPath:e.path,requiresAuth:e.matched.some(e=>e.meta.requireAuth),requiresAdmin:e.matched.some(e=>e.meta.requireAdmin)}),e.matched.some(e=>e.meta.requireAuth)?(console.log("Route requires authentication."),s&&r&&r.id?(console.log("User is authenticated."),e.matched.some(e=>e.meta.requireAdmin)?(console.log("Route requires admin privileges."),"admin"===r.role?(console.log("User is admin. Allowing navigation."),a()):(console.log("User is not admin. Redirecting to UserPage."),ye.a.Message.error("æ‚¨æ²¡æœ‰æƒé™è®¿é—®æ­¤é¡µé¢ï¼"),a({name:"UserPage"}))):(console.log("Route does not require admin. Checking for login page access..."),"Login"===e.name||"Register"===e.name?(console.log("User is logged in and trying to access Login/Register. Redirecting based on role."),a("admin"===r.role?{name:"AdminDashboard"}:{name:"UserPage"})):(console.log("Allowing navigation to non-admin, authenticated route."),a()))):(console.log("User is not authenticated. Redirecting to Login."),be.commit("REMOVE_INFO"),ye.a.Message.warning("è¯·å…ˆç™»å½•åŽå†è®¿é—®ï¼"),a({name:"Login",query:{redirect:e.fullPath}}))):(console.log("Route does not require authentication."),("Login"===e.name||"Register"===e.name)&&s&&r&&r.id?(console.log("User is logged in and trying to access public Login/Register. Redirecting based on role."),a("admin"===r.role?{name:"AdminDashboard"}:{name:"UserPage"})):(console.log("Allowing navigation to public route."),a()))}),fe.afterEach((e,t)=>{console.log("Navigation successful to: "+e.path)}),fe.onError(e=>{console.error("Router error:",e)}),s["default"].use(ye.a),s["default"].use(ke.a),s["default"].config.productionTip=!1,s["default"].prototype.$axios=_e.a,new s["default"]({router:fe,store:be,render:e=>e(c)}).$mount("#app")},"6b01":function(e,t,a){"use strict";a("ff3e")},"746c":function(e,t,a){"use strict";a("950d")},"82a3":function(e,t,a){"use strict";a("3765")},8470:function(e,t,a){},"84ab":function(e,t,a){},"8b01":function(e,t,a){},"8b9a":function(e,t,a){"use strict";a("c44d")},"950d":function(e,t,a){},a3e3:function(e,t,a){},ae4a:function(e,t,a){"use strict";a("8470")},c44d:function(e,t,a){},e590:function(e,t,a){},e792:function(e,t,a){"use strict";a("1544")},ff3e:function(e,t,a){}});
//# sourceMappingURL=app.2f72984e.js.map